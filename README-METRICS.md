# SmartCI Metrics - ä»»åŠ¡ç»Ÿè®¡æ¨¡å—

## å¿«é€Ÿå¼€å§‹

### æ„å»º
```bash
make build-metrics
# æˆ–
go build -o smart-ci-metrics ./cmd/metrics/main.go
```

### åŸºæœ¬ä½¿ç”¨

#### 1. æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡æ¦‚è§ˆ
```bash
./smart-ci-metrics all
```

#### 2. æŸ¥çœ‹ä»»åŠ¡æœ€è¿‘ä¸€æ¬¡æ‰§è¡Œ
```bash
./smart-ci-metrics latest -task <ä»»åŠ¡åç§°>
```

#### 3. æŸ¥çœ‹ä»»åŠ¡æ‰§è¡Œå†å²
```bash
# æœ€è¿‘7å¤©
./smart-ci-metrics list -task <ä»»åŠ¡åç§°> -days 7

# æœ€è¿‘24å°æ—¶
./smart-ci-metrics list -task <ä»»åŠ¡åç§°> -hours 24

# é™åˆ¶æ˜¾ç¤ºæ•°é‡
./smart-ci-metrics list -task <ä»»åŠ¡åç§°> -limit 10
```

#### 4. æŸ¥çœ‹ä»»åŠ¡ç»Ÿè®¡ä¿¡æ¯
```bash
# æœ€è¿‘30å¤©ç»Ÿè®¡
./smart-ci-metrics stats -task <ä»»åŠ¡åç§°> -days 30

# æ‰€æœ‰æ—¶é—´ç»Ÿè®¡
./smart-ci-metrics stats -task <ä»»åŠ¡åç§°>
```

## åŠŸèƒ½ç‰¹æ€§

- âœ… **è‡ªåŠ¨æ”¶é›†** - æ¯æ¬¡ä»»åŠ¡æ‰§è¡Œè‡ªåŠ¨è®°å½•å…ƒæ•°æ®
- ğŸ“Š **ä¸°å¯Œç»Ÿè®¡** - æˆåŠŸç‡ã€æ‰§è¡Œæ—¶é•¿ã€è¶‹åŠ¿åˆ†æ
- ğŸ” **çµæ´»æŸ¥è¯¢** - æ”¯æŒä»»åŠ¡åç§°ã€æ—¶é—´èŒƒå›´è¿‡æ»¤
- ğŸ“‹ **å¤šç§å±•ç¤º** - æœ€è¿‘æ‰§è¡Œã€å†å²åˆ—è¡¨ã€ç»Ÿè®¡æŠ¥å‘Š
- ğŸ’¾ **æŒä¹…å­˜å‚¨** - JSONæ ¼å¼ï¼Œæ˜“äºæ‰©å±•å’Œå¤‡ä»½

## æ•°æ®æ”¶é›†

æ¯æ¬¡ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ”¶é›†ä»¥ä¸‹ä¿¡æ¯ï¼š

- ä»»åŠ¡IDï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰
- ä»»åŠ¡åç§°å’Œç±»å‹
- å¼€å§‹/ç»“æŸæ—¶é—´
- æ‰§è¡Œæ—¶é•¿
- æ‰§è¡ŒçŠ¶æ€ï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰
- é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœå¤±è´¥ï¼‰
- æ—¥å¿—æ–‡ä»¶è·¯å¾„
- ä»»åŠ¡é…ç½®ä¿¡æ¯

æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨ä»»åŠ¡ç›®å½•çš„ `metadata.json` æ–‡ä»¶ä¸­ã€‚

## ç¤ºä¾‹è¾“å‡º

### ä»»åŠ¡æ¦‚è§ˆ
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ æ‰€æœ‰ä»»åŠ¡ç»Ÿè®¡ (å…± 3 ä¸ªä»»åŠ¡)
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ ä»»åŠ¡åç§°               â”‚ æ‰§è¡Œæ¬¡æ•° â”‚ æˆåŠŸç‡   â”‚ æœ€è¿‘æ‰§è¡Œ
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ backup-database        â”‚ 30       â”‚  93.33% â”‚ 12-03 15:04
â•‘ cleanup-logs           â”‚ 8        â”‚ 100.00% â”‚ 12-03 00:00
â•‘ deploy-app             â”‚ 15       â”‚  86.67% â”‚ 12-02 18:30
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### æœ€è¿‘ä¸€æ¬¡æ‰§è¡Œ
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ æœ€è¿‘ä¸€æ¬¡æ‰§è¡Œè®°å½•
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ ä»»åŠ¡åç§°: backup-database
â•‘ ä»»åŠ¡ID: 20251203-075207-328f77c8
â•‘ ä»»åŠ¡ç±»å‹: bash
â• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•‘ å¼€å§‹æ—¶é—´: 2025-12-03 07:52:07
â•‘ ç»“æŸæ—¶é—´: 2025-12-03 07:52:09
â•‘ æ‰§è¡Œæ—¶é•¿: 2.03ç§’
â• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•‘ æ‰§è¡ŒçŠ¶æ€: âœ… success
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### ç»Ÿè®¡ä¿¡æ¯
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ ä»»åŠ¡ç»Ÿè®¡: backup-database (æœ€è¿‘ 30 å¤©)
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ æ€»æ‰§è¡Œæ¬¡æ•°: 30 æ¬¡
â•‘ æˆåŠŸæ¬¡æ•°: âœ… 28 æ¬¡
â•‘ å¤±è´¥æ¬¡æ•°: âŒ 2 æ¬¡
â•‘ æˆåŠŸç‡: 93.33%
â• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•‘ å¹³å‡æ‰§è¡Œæ—¶é•¿: 1.3åˆ†é’Ÿ
â•‘ æœ€çŸ­æ‰§è¡Œæ—¶é•¿: 45.2ç§’
â•‘ æœ€é•¿æ‰§è¡Œæ—¶é•¿: 2.5åˆ†é’Ÿ
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## æµ‹è¯•

è¿è¡Œå®Œæ•´æµ‹è¯•ï¼š
```bash
./test-metrics.sh
```

è¿è¡Œæ¼”ç¤ºï¼š
```bash
./demo-metrics.sh
```

## æ–‡æ¡£

- **è¯¦ç»†æ–‡æ¡£**: [docs/metrics.md](docs/metrics.md)
- **å®ç°æ–‡æ¡£**: [METRICS_IMPLEMENTATION.md](METRICS_IMPLEMENTATION.md)
- **å˜æ›´æ—¥å¿—**: [CHANGES.md](CHANGES.md)

## é›†æˆç¤ºä¾‹

### Bashè„šæœ¬
```bash
#!/bin/bash
# æ£€æŸ¥ä»»åŠ¡å¥åº·çŠ¶å†µ
TASK="backup-database"
SUCCESS_RATE=$(./smart-ci-metrics stats -task $TASK -days 7 | grep "æˆåŠŸç‡" | awk '{print $2}' | tr -d '%')

if (( $(echo "$SUCCESS_RATE < 90" | bc -l) )); then
    echo "è­¦å‘Šï¼šä»»åŠ¡æˆåŠŸç‡ä½äº90%"
    # å‘é€å‘Šè­¦...
fi
```

### å®šæ—¶ç›‘æ§
```bash
# æ·»åŠ åˆ° crontab
0 * * * * /path/to/smart-ci-metrics stats -task backup-database -days 1 | mail -s "Backup Report" admin@example.com
```

## å…¼å®¹æ€§

- âœ… å‘åå…¼å®¹ï¼šæ—§ç‰ˆæœ¬ä»»åŠ¡æ— å…ƒæ•°æ®ä¸å½±å“ä½¿ç”¨
- âœ… ç‹¬ç«‹å·¥å…·ï¼šä¸ä¾èµ–æœåŠ¡å™¨è¿è¡Œ
- âœ… æ— éœ€é…ç½®ï¼šè‡ªåŠ¨å¯ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®

## æŠ€æœ¯æ ˆ

- Go 1.24
- JSON æ•°æ®å­˜å‚¨
- å‘½ä»¤è¡Œå‚æ•°è§£æ (flag)
- æ—¶é—´å¤„ç† (time)

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## License

ä¸ä¸»é¡¹ç›®ç›¸åŒ

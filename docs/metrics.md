# ä»»åŠ¡ç»Ÿè®¡ä¸æ•°æ®æ”¶é›†æ¨¡å—

## æ¦‚è¿°

SmartCI çš„ metrics æ¨¡å—æä¾›äº†å®Œæ•´çš„ä»»åŠ¡æ‰§è¡Œæ•°æ®æ”¶é›†ã€ç»Ÿè®¡å’ŒæŸ¥è¯¢åŠŸèƒ½ã€‚æ¯æ¬¡ä»»åŠ¡æ‰§è¡Œéƒ½ä¼šè‡ªåŠ¨è®°å½•è¯¦ç»†çš„å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬æ‰§è¡Œæ—¶é—´ã€çŠ¶æ€ã€æ—¥å¿—ç­‰ä¿¡æ¯ï¼Œå¹¶ä»¥ JSON æ ¼å¼å­˜å‚¨åœ¨ä»»åŠ¡ç›®å½•ä¸­ã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ… **è‡ªåŠ¨æ•°æ®æ”¶é›†**ï¼šæ¯æ¬¡ä»»åŠ¡æ‰§è¡Œæ—¶è‡ªåŠ¨è®°å½•å…ƒæ•°æ®
- ğŸ“Š **ç»Ÿè®¡åˆ†æ**ï¼šæä¾›æˆåŠŸç‡ã€æ‰§è¡Œæ—¶é•¿ç­‰ç»Ÿè®¡ä¿¡æ¯
- ğŸ” **çµæ´»æŸ¥è¯¢**ï¼šæ”¯æŒæŒ‰ä»»åŠ¡åç§°ã€æ—¶é—´èŒƒå›´æŸ¥è¯¢
- ğŸ“‹ **å¤šç§å±•ç¤ºæ–¹å¼**ï¼šæœ€è¿‘æ‰§è¡Œã€å†å²åˆ—è¡¨ã€ç»Ÿè®¡æŠ¥å‘Šç­‰
- ğŸ’¾ **æŒä¹…åŒ–å­˜å‚¨**ï¼šå…ƒæ•°æ®ä»¥ JSON æ ¼å¼å­˜å‚¨ï¼Œæ˜“äºæ‰©å±•

## æ•°æ®ç»“æ„

æ¯ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œä¼šåœ¨ä»»åŠ¡ç›®å½•ä¸­ç”Ÿæˆ `metadata.json` æ–‡ä»¶ï¼ŒåŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š

```json
{
  "task_id": "20231203-150405-a1b2c3d4",
  "task_name": "backup-database",
  "task_type": "bash",
  "start_time": "2023-12-03T15:04:05Z",
  "end_time": "2023-12-03T15:05:30Z",
  "duration": 85.5,
  "status": "success",
  "error": "",
  "log_file": "./logs/20231203-150405-a1b2c3d4/task.log",
  "task_dir": "./logs/20231203-150405-a1b2c3d4",
  "config": {
    "command": "pg_dump mydb > backup.sql",
    "working_dir": "/backups",
    "timeout": 600
  }
}
```

### å­—æ®µè¯´æ˜

- `task_id`: å”¯ä¸€ä»»åŠ¡IDï¼Œæ ¼å¼ä¸ºæ—¶é—´æˆ³+éšæœºæ•°
- `task_name`: ä»»åŠ¡åç§°ï¼Œå¯¹åº”é…ç½®æ–‡ä»¶ä¸­çš„ä»»åŠ¡å
- `task_type`: ä»»åŠ¡ç±»å‹ï¼ˆbash/repo/dockerï¼‰
- `start_time`: ä»»åŠ¡å¼€å§‹æ—¶é—´
- `end_time`: ä»»åŠ¡ç»“æŸæ—¶é—´
- `duration`: æ‰§è¡Œæ—¶é•¿ï¼ˆç§’ï¼‰
- `status`: æ‰§è¡ŒçŠ¶æ€ï¼ˆsuccess/failureï¼‰
- `error`: é”™è¯¯ä¿¡æ¯ï¼ˆå¤±è´¥æ—¶ï¼‰
- `log_file`: æ—¥å¿—æ–‡ä»¶è·¯å¾„
- `task_dir`: ä»»åŠ¡ç›®å½•è·¯å¾„
- `config`: ä»»åŠ¡é…ç½®ä¿¡æ¯

## å‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨

### æ„å»º

```bash
make build-metrics
# æˆ–
go build -o smart-ci-metrics ./cmd/metrics/main.go
```

### å‘½ä»¤è¯´æ˜

#### 1. æŸ¥çœ‹æœ€è¿‘ä¸€æ¬¡æ‰§è¡Œ (latest)

æ˜¾ç¤ºæŒ‡å®šä»»åŠ¡çš„æœ€è¿‘ä¸€æ¬¡æ‰§è¡Œè¯¦æƒ…ã€‚

```bash
./smart-ci-metrics latest -task <task_name> [-logdir <log_directory>]
```

**å‚æ•°ï¼š**
- `-task`: ä»»åŠ¡åç§°ï¼ˆå¿…éœ€ï¼‰
- `-logdir`: æ—¥å¿—ç›®å½•ï¼Œé»˜è®¤ä¸º `./logs`

**ç¤ºä¾‹ï¼š**
```bash
./smart-ci-metrics latest -task backup-database
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ æœ€è¿‘ä¸€æ¬¡æ‰§è¡Œè®°å½•
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ ä»»åŠ¡åç§°: backup-database
â•‘ ä»»åŠ¡ID: 20231203-150405-a1b2c3d4
â•‘ ä»»åŠ¡ç±»å‹: bash
â• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•‘ å¼€å§‹æ—¶é—´: 2023-12-03 15:04:05
â•‘ ç»“æŸæ—¶é—´: 2023-12-03 15:05:30
â•‘ æ‰§è¡Œæ—¶é•¿: 1.4åˆ†é’Ÿ
â• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•‘ æ‰§è¡ŒçŠ¶æ€: âœ… success
â• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•‘ ä»»åŠ¡ç›®å½•: ./logs/20231203-150405-a1b2c3d4
â•‘ æ—¥å¿—æ–‡ä»¶: ./logs/20231203-150405-a1b2c3d4/task.log
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

#### 2. åˆ—å‡ºå†å²è®°å½• (list)

åˆ—å‡ºæŒ‡å®šä»»åŠ¡åœ¨æŒ‡å®šæ—¶é—´èŒƒå›´å†…çš„æ‰€æœ‰æ‰§è¡Œè®°å½•ã€‚

```bash
./smart-ci-metrics list -task <task_name> [-hours <N>] [-days <N>] [-limit <N>] [-logdir <log_directory>]
```

**å‚æ•°ï¼š**
- `-task`: ä»»åŠ¡åç§°ï¼ˆå¿…éœ€ï¼‰
- `-hours`: æœ€è¿‘å¤šå°‘å°æ—¶ï¼ˆå¯é€‰ï¼‰
- `-days`: æœ€è¿‘å¤šå°‘å¤©ï¼ˆå¯é€‰ï¼‰
- `-limit`: æœ€å¤šæ˜¾ç¤ºæ¡æ•°ï¼Œé»˜è®¤ 20
- `-logdir`: æ—¥å¿—ç›®å½•ï¼Œé»˜è®¤ä¸º `./logs`

**ç¤ºä¾‹ï¼š**
```bash
# åˆ—å‡ºæœ€è¿‘7å¤©çš„æ‰§è¡Œè®°å½•
./smart-ci-metrics list -task backup-database -days 7

# åˆ—å‡ºæœ€è¿‘24å°æ—¶çš„æ‰§è¡Œè®°å½•
./smart-ci-metrics list -task backup-database -hours 24

# åˆ—å‡ºæœ€è¿‘2å¤©6å°æ—¶çš„æ‰§è¡Œè®°å½•
./smart-ci-metrics list -task backup-database -days 2 -hours 6

# åˆ—å‡ºæ‰€æœ‰æ‰§è¡Œè®°å½•ï¼Œé™åˆ¶10æ¡
./smart-ci-metrics list -task backup-database -limit 10
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ ä»»åŠ¡æ‰§è¡Œå†å²: backup-database (å…± 15 æ¡è®°å½•)
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ åºå· â”‚ å¼€å§‹æ—¶é—´           â”‚ æ—¶é•¿      â”‚ çŠ¶æ€ â”‚ ä»»åŠ¡ID
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ 1    â”‚ 2023-12-03 15:04:05 â”‚ 1.4åˆ†é’Ÿ   â”‚ âœ…  â”‚ 20231203-150405-a1b2c3d4
â•‘ 2    â”‚ 2023-12-03 02:00:15 â”‚ 1.2åˆ†é’Ÿ   â”‚ âœ…  â”‚ 20231203-020015-b2c3d4e5
â•‘ 3    â”‚ 2023-12-02 02:00:10 â”‚ 5.3ç§’     â”‚ âŒ  â”‚ 20231202-020010-c3d4e5f6
â•‘      â”‚ é”™è¯¯: database connection timeout
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

#### 3. æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯ (stats)

æ˜¾ç¤ºæŒ‡å®šä»»åŠ¡çš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬æˆåŠŸç‡ã€å¹³å‡æ—¶é•¿ç­‰ã€‚

```bash
./smart-ci-metrics stats -task <task_name> [-hours <N>] [-days <N>] [-logdir <log_directory>]
```

**å‚æ•°ï¼š**
- `-task`: ä»»åŠ¡åç§°ï¼ˆå¿…éœ€ï¼‰
- `-hours`: æœ€è¿‘å¤šå°‘å°æ—¶ï¼ˆå¯é€‰ï¼‰
- `-days`: æœ€è¿‘å¤šå°‘å¤©ï¼ˆå¯é€‰ï¼‰
- `-logdir`: æ—¥å¿—ç›®å½•ï¼Œé»˜è®¤ä¸º `./logs`

**ç¤ºä¾‹ï¼š**
```bash
# æŸ¥çœ‹æœ€è¿‘30å¤©çš„ç»Ÿè®¡
./smart-ci-metrics stats -task backup-database -days 30

# æŸ¥çœ‹æ‰€æœ‰æ—¶é—´çš„ç»Ÿè®¡
./smart-ci-metrics stats -task backup-database
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ ä»»åŠ¡ç»Ÿè®¡: backup-database (æœ€è¿‘ 30 å¤©)
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ æ€»æ‰§è¡Œæ¬¡æ•°: 30 æ¬¡
â•‘ æˆåŠŸæ¬¡æ•°: âœ… 28 æ¬¡
â•‘ å¤±è´¥æ¬¡æ•°: âŒ 2 æ¬¡
â•‘ æˆåŠŸç‡: 93.33%
â• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•‘ å¹³å‡æ‰§è¡Œæ—¶é•¿: 1.3åˆ†é’Ÿ
â•‘ æœ€çŸ­æ‰§è¡Œæ—¶é•¿: 45.2ç§’
â•‘ æœ€é•¿æ‰§è¡Œæ—¶é•¿: 2.5åˆ†é’Ÿ
â• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•‘ æœ€è¿‘ä¸€æ¬¡æ‰§è¡Œ: 2023-12-03 15:04:05 âœ…
â•‘ æœ€æ—©ä¸€æ¬¡æ‰§è¡Œ: 2023-11-03 02:00:05
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

#### 4. æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡æ¦‚è§ˆ (all)

æ˜¾ç¤ºæ‰€æœ‰ä»»åŠ¡çš„ç®€è¦ç»Ÿè®¡ä¿¡æ¯ã€‚

```bash
./smart-ci-metrics all [-logdir <log_directory>]
```

**å‚æ•°ï¼š**
- `-logdir`: æ—¥å¿—ç›®å½•ï¼Œé»˜è®¤ä¸º `./logs`

**ç¤ºä¾‹ï¼š**
```bash
./smart-ci-metrics all
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ æ‰€æœ‰ä»»åŠ¡ç»Ÿè®¡ (å…± 3 ä¸ªä»»åŠ¡)
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ ä»»åŠ¡åç§°               â”‚ æ‰§è¡Œæ¬¡æ•° â”‚ æˆåŠŸç‡   â”‚ æœ€è¿‘æ‰§è¡Œ
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•‘ backup-database        â”‚ 30       â”‚  93.33% â”‚ 12-03 15:04
â•‘ cleanup-logs           â”‚ 8        â”‚ 100.00% â”‚ 12-03 00:00
â•‘ deploy-app             â”‚ 15       â”‚  86.67% â”‚ 12-02 18:30
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## æ•°æ®å­˜å‚¨ç›®å½•ç»“æ„

```
logs/
â”œâ”€â”€ 20231203-150405-a1b2c3d4/        # ä»»åŠ¡ç›®å½•
â”‚   â”œâ”€â”€ metadata.json                # å…ƒæ•°æ®æ–‡ä»¶
â”‚   â”œâ”€â”€ task.log                     # ä»»åŠ¡æ—¥å¿—
â”‚   â””â”€â”€ ai-analysis.md               # AIåˆ†ææŠ¥å‘Šï¼ˆå¦‚æœå¯ç”¨ï¼‰
â”œâ”€â”€ 20231203-020015-b2c3d4e5/
â”‚   â”œâ”€â”€ metadata.json
â”‚   â””â”€â”€ task.log
â””â”€â”€ ...
```

## é›†æˆåˆ°è‡ªåŠ¨åŒ–è„šæœ¬

metrics å‘½ä»¤è¡Œå·¥å…·å¯ä»¥æ–¹ä¾¿åœ°é›†æˆåˆ°è‡ªåŠ¨åŒ–è„šæœ¬ä¸­ï¼š

### Bash è„šæœ¬ç¤ºä¾‹

```bash
#!/bin/bash

# æ£€æŸ¥ä»»åŠ¡æœ€è¿‘ä¸€æ¬¡æ‰§è¡ŒçŠ¶æ€
TASK_NAME="backup-database"
LATEST_STATUS=$(./smart-ci-metrics latest -task $TASK_NAME 2>/dev/null | grep "æ‰§è¡ŒçŠ¶æ€" | grep -q "âœ…" && echo "success" || echo "failure")

if [ "$LATEST_STATUS" = "failure" ]; then
    echo "è­¦å‘Šï¼šä»»åŠ¡ $TASK_NAME æœ€è¿‘ä¸€æ¬¡æ‰§è¡Œå¤±è´¥ï¼"
    # å‘é€å‘Šè­¦é€šçŸ¥...
fi

# æ£€æŸ¥æˆåŠŸç‡
SUCCESS_RATE=$(./smart-ci-metrics stats -task $TASK_NAME -days 7 | grep "æˆåŠŸç‡" | awk '{print $2}' | tr -d '%')
if (( $(echo "$SUCCESS_RATE < 80" | bc -l) )); then
    echo "è­¦å‘Šï¼šä»»åŠ¡ $TASK_NAME æœ€è¿‘7å¤©æˆåŠŸç‡ä½äº80%ï¼"
    # å‘é€å‘Šè­¦é€šçŸ¥...
fi
```

### Python è„šæœ¬ç¤ºä¾‹

```python
#!/usr/bin/env python3
import subprocess
import json

def get_task_metadata(task_name):
    """è·å–ä»»åŠ¡å…ƒæ•°æ®"""
    result = subprocess.run(
        ['./smart-ci-metrics', 'latest', '-task', task_name],
        capture_output=True,
        text=True
    )
    return result.stdout

def check_task_health(task_name, days=7):
    """æ£€æŸ¥ä»»åŠ¡å¥åº·çŠ¶å†µ"""
    result = subprocess.run(
        ['./smart-ci-metrics', 'stats', '-task', task_name, '-days', str(days)],
        capture_output=True,
        text=True
    )
    
    # è§£ææˆåŠŸç‡
    for line in result.stdout.split('\n'):
        if 'æˆåŠŸç‡' in line:
            success_rate = float(line.split(':')[1].strip().rstrip('%'))
            return success_rate >= 90.0
    
    return False

if __name__ == '__main__':
    tasks = ['backup-database', 'cleanup-logs', 'deploy-app']
    
    for task in tasks:
        if not check_task_health(task):
            print(f"è­¦å‘Šï¼šä»»åŠ¡ {task} å¥åº·çŠ¶å†µä¸ä½³ï¼")
```

## API é›†æˆï¼ˆæœªæ¥æ‰©å±•ï¼‰

æœªæ¥å¯ä»¥å°† metrics åŠŸèƒ½é›†æˆåˆ° HTTP API ä¸­ï¼š

```bash
# è·å–æœ€è¿‘æ‰§è¡Œ
curl http://localhost:8080/api/metrics/latest?task=backup-database

# è·å–æ‰§è¡Œåˆ—è¡¨
curl http://localhost:8080/api/metrics/list?task=backup-database&days=7

# è·å–ç»Ÿè®¡ä¿¡æ¯
curl http://localhost:8080/api/metrics/stats?task=backup-database&days=30
```

## æœ€ä½³å®è·µ

1. **å®šæœŸæ£€æŸ¥**ï¼šä½¿ç”¨ cron å®šæœŸæ‰§è¡Œ metrics å‘½ä»¤ï¼Œç›‘æ§ä»»åŠ¡å¥åº·çŠ¶å†µ
2. **å‘Šè­¦é›†æˆ**ï¼šå°† metrics è¾“å‡ºé›†æˆåˆ°å‘Šè­¦ç³»ç»Ÿï¼ˆå¦‚ PagerDutyã€é’‰é’‰ç­‰ï¼‰
3. **æ—¥å¿—æ¸…ç†**ï¼šå®šæœŸæ¸…ç†æ—§çš„ä»»åŠ¡ç›®å½•ï¼Œé¿å…ç£ç›˜ç©ºé—´å ç”¨è¿‡å¤š
4. **æ•°æ®å¤‡ä»½**ï¼šé‡è¦ä»»åŠ¡çš„å…ƒæ•°æ®åº”å®šæœŸå¤‡ä»½
5. **è¶‹åŠ¿åˆ†æ**ï¼šç»“åˆæ—¶é—´åºåˆ—æ•°æ®åº“ï¼ˆå¦‚ InfluxDBï¼‰è¿›è¡Œé•¿æœŸè¶‹åŠ¿åˆ†æ

## æ•…éšœæ’æŸ¥

### æ‰¾ä¸åˆ°ä»»åŠ¡è®°å½•

å¦‚æœæç¤º"æœªæ‰¾åˆ°ä»»åŠ¡çš„æ‰§è¡Œè®°å½•"ï¼Œå¯èƒ½åŸå› ï¼š

1. ä»»åŠ¡ä»æœªæ‰§è¡Œè¿‡
2. ä»»åŠ¡åç§°æ‹¼å†™é”™è¯¯
3. æ—¥å¿—ç›®å½•è·¯å¾„ä¸æ­£ç¡®
4. å…ƒæ•°æ®æ–‡ä»¶æŸåæˆ–è¢«åˆ é™¤

è§£å†³æ–¹æ³•ï¼š
```bash
# æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å­˜åœ¨
./smart-ci-metrics all

# æ£€æŸ¥æ—¥å¿—ç›®å½•
ls -la ./logs/

# æ‰‹åŠ¨æ£€æŸ¥å…ƒæ•°æ®æ–‡ä»¶
find ./logs -name "metadata.json" -exec cat {} \; | grep "task_name"
```

### å…ƒæ•°æ®ç¼ºå¤±

è€ç‰ˆæœ¬æ‰§è¡Œçš„ä»»åŠ¡å¯èƒ½æ²¡æœ‰å…ƒæ•°æ®æ–‡ä»¶ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è¯†åˆ«ï¼š

```bash
# æŸ¥æ‰¾æ²¡æœ‰ metadata.json çš„ä»»åŠ¡ç›®å½•
find ./logs -type d -mindepth 1 -maxdepth 1 ! -exec test -f {}/metadata.json \; -print
```

## æ€§èƒ½è€ƒè™‘

- metrics å·¥å…·ä¼šæ‰«ææ•´ä¸ªæ—¥å¿—ç›®å½•ï¼Œå¤§é‡ä»»åŠ¡è®°å½•å¯èƒ½å½±å“æŸ¥è¯¢é€Ÿåº¦
- å»ºè®®å®šæœŸå½’æ¡£æ—§çš„ä»»åŠ¡ç›®å½•
- å¯¹äºé«˜é¢‘ä»»åŠ¡ï¼Œè€ƒè™‘ä½¿ç”¨æ—¶é—´èŒƒå›´è¿‡æ»¤å‡å°‘æ•°æ®é‡

## æœªæ¥è®¡åˆ’

- [ ] æ”¯æŒå¯¼å‡ºä¸º CSV/Excel æ ¼å¼
- [ ] å›¾å½¢åŒ–å±•ç¤ºï¼ˆé›†æˆåˆ° Web UIï¼‰
- [ ] å®æ—¶ç›‘æ§å’Œå‘Šè­¦
- [ ] ä»»åŠ¡æ‰§è¡Œè¶‹åŠ¿å›¾è¡¨
- [ ] ä¸æ—¶é—´åºåˆ—æ•°æ®åº“é›†æˆ
- [ ] ä»»åŠ¡æ‰§è¡Œæ¯”è¾ƒåŠŸèƒ½
- [ ] è‡ªå®šä¹‰æŠ¥å‘Šæ¨¡æ¿
